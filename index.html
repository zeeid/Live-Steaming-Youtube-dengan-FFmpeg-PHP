<!DOCTYPE html>
<html>
<head>
	<title>Live Streaming</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
	<h1>Live Streaming</h1>

	<form id="livestream-form">
		<label for="stream_key">Stream Key:</label>
		<input type="text" id="stream_key" name="stream_key" required><br><br>

		<label for="bitrate">Video Bitrate:</label>
		<select id="bitrate" name="bitrate">
			<option value="500k">500k</option>
			<option value="1000k">1000k</option>
			<option value="2000k">2000k</option>
		</select><br><br>

		<label for="resolution">Video Resolution:</label>
		<input type="text" id="resolution" name="resolution" value="640x480" required><br><br>

		<label for="framerate">Video Framerate:</label>
		<input type="number" id="framerate" name="framerate" value="30" min="1" max="60" required><br><br>

		<label for="codec">Video Codec:</label>
		<select id="codec" name="codec">
			<option value="libx264">libx264</option>
			<option value="libx265">libx265</option>
			<option value="vp8">vp8</option>
			<option value="vp9">vp9</option>
		</select><br><br>

		<button type="submit">Start Streaming</button>
	</form>

	<div id="log"></div>

	<script>
		$(document).ready(function() {
			$('#livestream-form').on('submit', function(event) {
				event.preventDefault();

				// get form inputs
				var stream_key = $('#stream_key').val();
				var bitrate = $('#bitrate').val();
				var resolution = $('#resolution').val();
				var framerate = $('#framerate').val();
				var codec = $('#codec').val();

				// send ajax request to start livestream
				$.ajax({
					url: 'livestream.php',
					type: 'POST',
					data: {stream_key: stream_key, bitrate: bitrate, resolution: resolution, framerate: framerate, codec: codec},
					dataType: 'json',
					beforeSend: function() {
						$('#log').html('<p>Memulai Livestreaming...</p>');
					},
					success: function(response) {
						if (response.status == 'success') {
							$('#log').html('<p>Livestream Berhasil Dimulai.</p>');
						} else {
							$('#log').html('<p>' + response.message + '</p>');
						}
					},
					error: function() {
						$('#log').html('<p>Terjadi Kesalahan. Silakan Coba Lagi.</p>');
					}
				});
			});
		});
	</script>
</body>
</html>
